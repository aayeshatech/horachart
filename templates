<!DOCTYPE html>
<html>
<head>
    <title>Astrology Calculator</title>
    <style>
        body { font-family: Arial; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); margin: 0; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; }
        .header { background: #ff6b6b; color: white; padding: 20px; text-align: center; border-radius: 10px; margin-bottom: 20px; }
        .input-section { background: rgba(255,255,255,0.9); padding: 20px; border-radius: 10px; margin-bottom: 20px; }
        .input-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .input-group { display: flex; flex-direction: column; }
        .input-group label { font-weight: bold; margin-bottom: 5px; }
        .input-group input { padding: 10px; border: 2px solid #ddd; border-radius: 5px; }
        .btn { background: #00c851; color: white; padding: 15px 30px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; }
        .alert { background: #ff6b6b; color: white; padding: 15px; margin: 20px 0; border-radius: 5px; text-align: center; }
        .results { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
        .panel { background: rgba(255,255,255,0.9); padding: 20px; border-radius: 10px; }
        .panel h3 { color: #333; margin-bottom: 15px; }
        .table { width: 100%; border-collapse: collapse; background: white; border-radius: 5px; overflow: hidden; }
        .table th { background: #333; color: white; padding: 10px; }
        .table td { padding: 10px; border-bottom: 1px solid #eee; text-align: center; }
        .good { color: #00c851; font-weight: bold; }
        .bad { color: #ff6b6b; font-weight: bold; }
        .neutral { color: #ffc107; font-weight: bold; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåü Vedic Astrology Calculator üåü</h1>
            <p>Real-time Planetary Positions & Transit Analysis</p>
        </div>

        <div class="input-section">
            <div class="input-grid">
                <div class="input-group">
                    <label>Name:</label>
                    <input type="text" id="name" placeholder="Your name">
                </div>
                <div class="input-group">
                    <label>Birth Date:</label>
                    <input type="date" id="date" value="1990-01-01">
                </div>
                <div class="input-group">
                    <label>Birth Time:</label>
                    <input type="time" id="time" value="12:00">
                </div>
                <div class="input-group">
                    <label>Birth Place:</label>
                    <input type="text" id="place" placeholder="City, Country">
                </div>
            </div>
            <center><button class="btn" onclick="calculate()">üîÆ Calculate Chart</button></center>
        </div>

        <div class="alert">
            <h3>‚ö†Ô∏è Mercury Retrograde Alert: August 7, 2025</h3>
            <p>Communications and family matters need extra caution until August 11, 2025</p>
        </div>

        <div class="results">
            <div class="panel">
                <h3>üìã Personal Info</h3>
                <div id="personalInfo">Click Calculate Chart</div>
            </div>
            <div class="panel">
                <h3>‚è∞ Current Dasha</h3>
                <div id="dashaInfo">Dasha info will appear here</div>
            </div>
        </div>

        <table class="table">
            <thead>
                <tr><th>Planet</th><th>Sign</th><th>Degree</th><th>House</th><th>Nakshatra</th><th>Lord</th><th>Status</th></tr>
            </thead>
            <tbody id="planetTable">
                <tr><td colspan="7">Click Calculate Chart to see positions</td></tr>
            </tbody>
        </table>
    </div>

    <script>
        async function calculate() {
            const data = {
                name: document.getElementById('name').value || 'Unknown',
                date: document.getElementById('date').value,
                time: document.getElementById('time').value,
                place: document.getElementById('place').value || 'Unknown'
            };

            try {
                const response = await fetch('/calculate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                
                document.getElementById('personalInfo').innerHTML = `
                    <p><strong>Name:</strong> ${result.personal_info.name}</p>
                    <p><strong>Date:</strong> ${result.personal_info.date}</p>
                    <p><strong>Weekday:</strong> ${result.personal_info.weekday}</p>
                `;

                document.getElementById('dashaInfo').innerHTML = `
                    <p><strong>Main Dasha:</strong> ${result.dasha_info.current_dasha}</p>
                    <p><strong>Antardasha:</strong> ${result.dasha_info.current_antardasha}</p>
                `;

                const tbody = document.getElementById('planetTable');
                tbody.innerHTML = '';
                
                result.planetary_positions.forEach(planet => {
                    const motion = planet.motion ? ` (${planet.motion})` : '';
                    tbody.innerHTML += `
                        <tr>
                            <td>${planet.planet}</td>
                            <td>${planet.sign}${motion}</td>
                            <td>${planet.degree}¬∞</td>
                            <td>${planet.house}</td>
                            <td>${planet.nakshatra}</td>
                            <td>${planet.lord}</td>
                            <td class="${planet.status}">${planet.status.toUpperCase()}</td>
                        </tr>
                    `;
                });

            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        window.onload = function() {
            document.getElementById('date').value = new Date().toISOString().split('T')[0];
            calculate();
        };
    </script>
</body>
</html>
